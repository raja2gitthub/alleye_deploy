import{r as n,j as t}from"./index-EZVcE4NK.js";import{C as A}from"./Card-CUfzvBst.js";import"https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/+esm";const S=a=>t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24",strokeWidth:1.5,stroke:"currentColor",...a,children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"})}),D=({title:a,metrics:r})=>t.jsxs("div",{className:"glass-card p-4 rounded-lg flex flex-col gap-3 text-sm",children:[t.jsx("h4",{className:"font-bold text-base text-text-main truncate",children:a}),t.jsxs("div",{className:"flex justify-between border-t border-border pt-2",children:[t.jsx("span",{className:"text-text-secondary",children:"Watch Rate"}),t.jsxs("span",{className:"font-semibold text-highlight",children:[r.watchRate.toFixed(1),"%"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-text-secondary",children:"Avg. Quiz Score"}),t.jsxs("span",{className:"font-semibold text-secondary",children:[r.avgQuizScore.toFixed(1),"%"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-text-secondary",children:"Retention (30/60/90d)"}),t.jsx("span",{className:"font-semibold text-text-main",children:r.retention})]}),t.jsxs("div",{className:"border-t border-border pt-2",children:[t.jsx("p",{className:"text-text-secondary",children:"Top Missed Concept:"}),t.jsx("p",{className:"font-semibold text-amber-400 italic mt-1",children:r.topMissedConcept})]})]}),F=({content:a,analytics:r,cyberAnalytics:d})=>{const[i,u]=n.useState(""),[o,p]=n.useState({category:"All",difficulty:"All"}),g=n.useMemo(()=>["All",...Array.from(new Set(a.map(e=>e.category).filter(Boolean)))],[a]),j=n.useMemo(()=>["All","Intro","Intermediate","Advanced"],[]),m=n.useMemo(()=>a.map(e=>{const s=r.filter(l=>l.content_id===e.id),c=d.filter(l=>l.content_id===e.id),h=s.filter(l=>l.event_type==="start").length,y=s.filter(l=>l.event_type==="complete").length,w=h>0?y/h*100:0,v=c.reduce((l,C)=>l+C.score,0),N=c.length>0?v/c.length:0,b=`${Math.floor(70+Math.random()*10)}% / ${Math.floor(65+Math.random()*10)}% / ${Math.floor(60+Math.random()*10)}%`,M=["Social Engineering","Password Hygiene","Data Handling"][Math.floor(Math.random()*3)];return{id:e.id,title:e.title,category:e.category,difficulty:e.difficulty,metrics:{watchRate:w,avgQuizScore:N,retention:b,topMissedConcept:M}}}),[a,r,d]),x=n.useMemo(()=>{let e=m;return i&&(e=e.filter(s=>s.title.toLowerCase().includes(i.toLowerCase()))),o.category!=="All"&&(e=e.filter(s=>s.category===o.category)),o.difficulty!=="All"&&(e=e.filter(s=>s.difficulty===o.difficulty)),e},[m,i,o]),f=e=>{p(s=>({...s,[e.target.name]:e.target.value}))};return t.jsxs("div",{className:"animate-fade-in",children:[t.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-6 gap-4",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold",children:"Drill-Down View"}),t.jsx("p",{className:"text-text-secondary",children:"Micro-level insights for each training module."})]}),t.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-4 w-full md:w-auto",children:[t.jsxs("div",{className:"relative w-full sm:w-auto",children:[t.jsx(S,{className:"w-5 h-5 absolute left-3 top-1/2 -translate-y-1/2 text-text-secondary"}),t.jsx("input",{type:"text",placeholder:"Search by title...",value:i,onChange:e=>u(e.target.value),className:"form-input pl-10 w-full sm:w-52"})]}),t.jsx("select",{name:"category",value:o.category,onChange:f,className:"form-select w-full sm:w-auto",children:g.map(e=>t.jsx("option",{value:e,children:e},e))}),t.jsx("select",{name:"difficulty",value:o.difficulty,onChange:f,className:"form-select w-full sm:w-auto",children:j.map(e=>t.jsx("option",{value:e,children:e},e))})]})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:x.length>0?x.map(e=>t.jsx(D,{title:e.title,metrics:e.metrics},e.id)):t.jsx(A,{className:"md:col-span-2 lg:col-span-3 xl:col-span-4 text-center",children:t.jsx("p",{className:"text-text-secondary",children:"No content modules match the current filters."})})})]})};export{F as default};
