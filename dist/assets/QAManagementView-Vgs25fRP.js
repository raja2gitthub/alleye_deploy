import{r as g,j as e,B as o,s as m}from"./index-EZVcE4NK.js";import{V as j}from"./ViewHeader-Bz2swllQ.js";import{C as x}from"./Card-CUfzvBst.js";import{M as f}from"./Modal-Dywz6qs9.js";import"https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/+esm";const q=({qandaItems:l,currentUser:u})=>{const[n,r]=g.useState(null),h=async s=>{if(!n)return;const{error:a}=await m.from("qanda").update({answer:s,answered_by:u.id,answered_at:new Date().toISOString()}).eq("id",n.id);a?alert("Error submitting answer: "+a.message):r(null)},p=async s=>{const{error:a}=await m.from("qanda").update({is_faq:!s.is_faq}).eq("id",s.id);a&&alert("Error toggling FAQ: "+a.message)},t=l.filter(s=>!s.answer),i=l.filter(s=>s.answer);return e.jsxs("div",{className:"animate-fade-in",children:[e.jsx(j,{title:"Q&A Management",subtitle:"Respond to user questions and manage the FAQ."}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs(x,{children:[e.jsxs("h2",{className:"text-xl font-bold mb-4",children:["Pending Questions (",t.length,")"]}),e.jsxs("div",{className:"space-y-4 max-h-[60vh] overflow-y-auto",children:[t.map(s=>{var a,d,c;return e.jsx("div",{className:"p-3 bg-sidebar-accent rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("img",{src:((a=s.user)==null?void 0:a.avatar_url)||`https://i.pravatar.cc/150?u=${s.user_id}`,alt:(d=s.user)==null?void 0:d.name,className:"w-8 h-8 rounded-full"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-text-main",children:s.question}),e.jsxs("p",{className:"text-xs text-text-secondary",children:["Asked by ",((c=s.user)==null?void 0:c.name)||"Unknown"," on ",new Date(s.created_at).toLocaleDateString()]}),e.jsx(o,{size:"sm",variant:"secondary",className:"mt-2",onClick:()=>r(s),children:"Answer"})]})]})},s.id)}),t.length===0&&e.jsx("p",{className:"text-text-secondary",children:"No pending questions."})]})]}),e.jsxs(x,{children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Answered Questions"}),e.jsxs("div",{className:"space-y-4 max-h-[60vh] overflow-y-auto",children:[i.map(s=>{var a;return e.jsxs("div",{className:"p-3 bg-sidebar-accent rounded-lg",children:[e.jsx("p",{className:"font-semibold text-text-main",children:s.question}),e.jsx("p",{className:"text-sm my-2 p-2 bg-background rounded-md",children:s.answer}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("p",{className:"text-xs text-text-secondary",children:["Answered by ",((a=s.admin)==null?void 0:a.name)||"Admin"]}),e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.is_faq,onChange:()=>p(s),className:"h-4 w-4 rounded"}),e.jsx("span",{className:"ml-2 text-xs",children:"Mark as FAQ"})]})]})]},s.id)}),i.length===0&&e.jsx("p",{className:"text-text-secondary",children:"No questions have been answered yet."})]})]})]}),n&&e.jsx(f,{isOpen:!!n,onClose:()=>r(null),title:"Answer Question",children:e.jsxs("div",{children:[e.jsx("p",{className:"mb-2 p-3 bg-sidebar-accent rounded-lg",children:n.question}),e.jsxs("form",{onSubmit:s=>{s.preventDefault(),h(s.currentTarget.elements.namedItem("answer").value)},children:[e.jsx("textarea",{name:"answer",placeholder:"Your answer...",className:"form-input",rows:5,required:!0}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx(o,{type:"submit",children:"Submit Answer"})})]})]})})]})};export{q as default};
