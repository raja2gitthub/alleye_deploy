import{g as V,r as u,j as n}from"./index-EZVcE4NK.js";import{f as Z}from"./xapiLrsClient-D85D4vVW.js";import{C as k}from"./Card-CUfzvBst.js";import{V as J}from"./ViewHeader-C_f75zHr.js";import{D as X}from"./DataTable-iWaiuJ_V.js";import{y as W,z as K,r as ee,A as re,j as te,B as ae,C as ne,u as B,E as ie,Z as se,L as T,c as H,P as oe,F as ce,G as R,x as L,H as le,a as de,I as ue,J as me,R as fe,T as xe}from"./CategoricalChart-DwX3OCgn.js";import{s as ye,a as ve,R as pe,P as ge,b as he,c as be}from"./RadarChart-KMhvE571.js";import"https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/+esm";import"./ActivePoints-DLfukH-g.js";import"./PolarChart-DFVWZZVg.js";var S={},N={},D;function je(){return D||(D=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(t,a){if(t.length===0)return;let s=t[0],i=a(s);for(let c=1;c<t.length;c++){const m=t[c],o=a(m);o>i&&(i=o,s=m)}return s}e.maxBy=r})(N)),N}var I;function ke(){return I||(I=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=je(),t=K(),a=W();function s(i,c){if(i!=null)return r.maxBy(Array.from(i),a.iteratee(c??t.identity))}e.maxBy=s})(S)),S}var O,_;function Pe(){return _||(_=1,O=ke().maxBy),O}var we=Pe();const Be=V(we);var A={},E={},q;function Se(){return q||(q=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(t,a){if(t.length===0)return;let s=t[0],i=a(s);for(let c=1;c<t.length;c++){const m=t[c],o=a(m);o<i&&(i=o,s=m)}return s}e.minBy=r})(E)),E}var $;function Ne(){return $||($=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=Se(),t=K(),a=W();function s(i,c){if(i!=null)return r.minBy(Array.from(i),a.iteratee(c??t.identity))}e.minBy=s})(A)),A}var C,z;function Oe(){return z||(z=1,C=Ne().minBy),C}var Ae=Oe();const Ee=V(Ae);var Ce=["cx","cy","angle","axisLine"],Me=["angle","tickFormatter","stroke","tick"];function b(){return b=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var a in t)({}).hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},b.apply(null,arguments)}function F(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),t.push.apply(t,a)}return t}function v(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?F(Object(t),!0).forEach(function(a){Te(e,a,t[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):F(Object(t)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))})}return e}function Te(e,r,t){return(r=Re(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function Re(e){var r=Le(e,"string");return typeof r=="symbol"?r:r+""}function Le(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var a=t.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function U(e,r){if(e==null)return{};var t,a,s=De(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)t=i[a],r.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(s[t]=e[t])}return s}function De(e,r){if(e==null)return{};var t={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;t[a]=e[a]}return t}var Ie="radiusAxis";function _e(e){var r=te();return u.useEffect(()=>(r(ae(e)),()=>{r(ne(e))})),null}var qe=(e,r,t,a)=>{var{coordinate:s}=e;return R(t,a,s,r)},$e=e=>{var r;switch(e){case"left":r="end";break;case"right":r="start";break;default:r="middle";break}return r},ze=(e,r,t,a)=>{var s=Be(a,c=>c.coordinate||0),i=Ee(a,c=>c.coordinate||0);return{cx:r,cy:t,startAngle:e,endAngle:e,innerRadius:(i==null?void 0:i.coordinate)||0,outerRadius:(s==null?void 0:s.coordinate)||0,clockWise:!1}},Fe=(e,r)=>{var{cx:t,cy:a,angle:s,axisLine:i}=e,c=U(e,Ce),m=r.reduce((x,p)=>[Math.min(x[0],p.coordinate),Math.max(x[1],p.coordinate)],[1/0,-1/0]),o=R(t,a,m[0],s),f=R(t,a,m[1],s),y=v(v(v({},L(c)),{},{fill:"none"},L(i)),{},{x1:o.x,y1:o.y,x2:f.x,y2:f.y});return u.createElement("line",b({className:"recharts-polar-radius-axis-line"},y))},Ve=(e,r,t)=>{var a;return u.isValidElement(e)?a=u.cloneElement(e,r):typeof e=="function"?a=e(r):a=u.createElement(me,b({},r,{className:"recharts-polar-radius-axis-tick-value"}),t),a},We=(e,r)=>{var{angle:t,tickFormatter:a,stroke:s,tick:i}=e,c=U(e,Me),m=$e(e.orientation),o=L(c),f=le(i),y=r.map((x,p)=>{var h=qe(x,e.angle,e.cx,e.cy),P=v(v(v(v({textAnchor:m,transform:"rotate(".concat(90-t,", ").concat(h.x,", ").concat(h.y,")")},o),{},{stroke:"none",fill:s},f),{},{index:p},h),{},{payload:x});return u.createElement(T,b({className:H("recharts-polar-radius-axis-tick",ue(i)),key:"tick-".concat(x.coordinate)},de(e,x,p)),Ve(i,P,a?a(x.value,p):x.value))});return u.createElement(T,{className:"recharts-polar-radius-axis-ticks"},y)},Ke=e=>{var{radiusAxisId:r}=e,t=B(ie),a=B(o=>ye(o,"radiusAxis",r)),s=B(o=>ve(o,"radiusAxis",r,!1));if(t==null||!s||!s.length||a==null)return null;var i=v(v(v({},e),{},{scale:a},t),{},{radius:t.outerRadius}),{tick:c,axisLine:m}=i;return u.createElement(se,{zIndex:i.zIndex},u.createElement(T,{className:H("recharts-polar-radius-axis",Ie,i.className)},m&&Fe(i,s),c&&We(i,s),u.createElement(oe,ze(i.angle,i.cx,i.cy,s),u.createElement(ce,{label:i.label}),i.children)))};function Y(e){var r=ee(e,re);return u.createElement(u.Fragment,null,u.createElement(_e,{domain:r.domain,id:r.radiusAxisId,scale:r.scale,type:r.type,dataKey:r.dataKey,unit:void 0,name:r.name,allowDuplicatedCategory:r.allowDuplicatedCategory,allowDataOverflow:r.allowDataOverflow,reversed:r.reversed,includeHidden:r.includeHidden,allowDecimals:r.allowDecimals,ticks:r.ticks,tickCount:r.tickCount,tick:r.tick}),u.createElement(Ke,r))}Y.displayName="PolarRadiusAxis";const He=e=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24",strokeWidth:1.5,stroke:"currentColor",...e,children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),Ue=e=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24",strokeWidth:1.5,stroke:"currentColor",...e,children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 013 19.875v-6.75zM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V8.625zM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V4.125z"})}),Ye=e=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24",strokeWidth:1.5,stroke:"currentColor",...e,children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z"})}),M=({title:e,value:r,icon:t})=>n.jsx(k,{children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"p-3 bg-primary/20 rounded-lg text-primary",children:t}),n.jsxs("div",{children:[n.jsx("div",{className:"text-3xl font-bold",children:r}),n.jsx("div",{className:"text-sm opacity-70",children:e})]})]})}),ir=({user:e,allContent:r})=>{const[t,a]=u.useState([]),[s,i]=u.useState(!0);u.useEffect(()=>{(async()=>{i(!0);const f=await Z({agent:e,limit:100});a(f),i(!1)})()},[e]);const c=u.useMemo(()=>{const o=e.progress||{},f=Object.entries(o).filter(([l,d])=>d.status==="completed"),y=f.map(([l,d])=>d.score).filter(l=>l!==void 0),x=y.length>0?y.reduce((l,d)=>l+d,0)/y.length:0,p=new Set(f.map(([l,d])=>parseInt(l))),h=r.filter(l=>p.has(l.id)).reduce((l,d)=>l+(d.duration_sec||0),0),P=Math.floor(h/60),j={};r.forEach(l=>{const d=o[l.id];(d==null?void 0:d.status)==="completed"&&typeof d.score=="number"&&l.category&&(j[l.category]||(j[l.category]=[]),j[l.category].push(d.score))});const G=Object.entries(j).map(([l,d])=>({subject:l,A:d.reduce((g,w)=>g+w,0)/d.length,fullMark:100})).slice(0,6),Q=f.map(([l,d])=>{if(typeof d.score=="number"){const g=r.find(w=>w.id===parseInt(l));return g?{...g,id:g.id,score:d.score,passing_score:g.passing_score??70}:null}return null}).filter(l=>!!l);return{stats:{completed:f.length,avgScore:x.toFixed(0),learningTime:P},categoryProficiency:G,quizPerformances:Q}},[e.progress,r]),m=u.useMemo(()=>t.slice(0,5).map(o=>{var f,y;return{id:o.id,verb:o.verb.display["en-US"]||"did",object:((y=(f=o.object.definition)==null?void 0:f.name)==null?void 0:y["en-US"])||"something",timestamp:new Date(o.timestamp).toLocaleString()}}),[t]);return s?n.jsx("div",{className:"flex h-full w-full items-center justify-center",children:n.jsx("span",{className:"loading loading-lg"})}):n.jsxs("div",{className:"animate-fade-in space-y-6",children:[n.jsx(J,{title:"My Analytics Dashboard",subtitle:`Here's a detailed look at your learning journey, ${e.name}.`}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[n.jsx(M,{title:"Courses Completed",value:c.stats.completed.toString(),icon:n.jsx(He,{className:"w-8 h-8"})}),n.jsx(M,{title:"Average Score",value:`${c.stats.avgScore}%`,icon:n.jsx(Ue,{className:"w-8 h-8"})}),n.jsx(M,{title:"Total Learning Time",value:`${c.stats.learningTime} min`,icon:n.jsx(Ye,{className:"w-8 h-8"})})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[n.jsxs(k,{className:"lg:col-span-2",children:[n.jsx("h3",{className:"text-xl font-bold mb-4",children:"Recent Activity"}),m.length>0?n.jsx("ul",{className:"space-y-4",children:m.map(o=>n.jsxs("li",{className:"flex items-center gap-4 p-3 bg-base-300/50 rounded-lg",children:[n.jsx("div",{className:"w-2 h-10 bg-primary rounded-full"}),n.jsxs("div",{children:[n.jsxs("p",{className:"font-semibold text-base-content",children:["You ",o.verb," ",n.jsx("span",{className:"text-primary",children:o.object})]}),n.jsx("p",{className:"text-xs opacity-70",children:o.timestamp})]})]},o.id))}):n.jsx("p",{className:"opacity-70",children:"No recent activity to show."})]}),n.jsxs(k,{children:[n.jsx("h3",{className:"text-xl font-bold mb-4",children:"Category Proficiency"}),c.categoryProficiency.length>0?n.jsx(fe,{width:"100%",height:250,children:n.jsxs(pe,{cx:"50%",cy:"50%",outerRadius:"80%",data:c.categoryProficiency,children:[n.jsx(ge,{stroke:"hsl(var(--b3))"}),n.jsx(he,{dataKey:"subject",tick:{fill:"hsl(var(--bc))",fontSize:12}}),n.jsx(Y,{angle:30,domain:[0,100],tick:{fill:"hsl(var(--bc))",fontSize:10}}),n.jsx(xe,{contentStyle:{backgroundColor:"hsl(var(--b2))",border:"1px solid hsl(var(--b3))"}}),n.jsx(be,{name:"Average Score",dataKey:"A",stroke:"hsl(var(--p))",fill:"hsl(var(--p))",fillOpacity:.6})]})}):n.jsx("p",{className:"opacity-70 flex items-center justify-center h-full",children:"Complete some quizzes to see your proficiency."})]})]}),n.jsxs(k,{children:[n.jsx("h3",{className:"text-xl font-bold mb-4",children:"Quiz Performance Details"}),n.jsx(X,{columns:[{key:"title",header:"Quiz Title"},{key:"category",header:"Category"},{key:"score",header:"Your Score",render:o=>`${o.score}%`},{key:"passing_score",header:"Passing Score",render:o=>`${o.passing_score}%`},{key:"status",header:"Status",render:o=>o.score>=o.passing_score?n.jsx("span",{className:"badge badge-success badge-outline",children:"Passed"}):n.jsx("span",{className:"badge badge-error badge-outline",children:"Failed"})}],data:c.quizPerformances})]})]})};export{ir as default};
